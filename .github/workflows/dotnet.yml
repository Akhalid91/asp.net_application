name: Publish .NET Project to Remote Server

on:
  push:
    branches:
      - main

jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Setup .NET
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: '7.0.202'

    - name: Publish
      run: dotnet publish -c Release --no-self-contained -o ./publish

    - name: Copy to remote server
      uses: appleboy/ssh-action@v0.1.7
      with:
        host: 203.215.171.93
        username: Administrator
        password: Helloitsbspo1!
        port: 22
        script: |
        mkdir -p /tmp/publish
            cd /tmp/publish
            scp -r ${{ github.workspace }}/publish/* Administrator@203.215.171.93:C:\New folder\test
          #New-Item -ItemType Directory -Force -Path "C:\inetpub\wwwroot\myapp"
         # Copy-Item -Path "./publish/*" -Destination "C:\inetpub\wwwroot\myapp" -Recurse

    #- name: Remove publish folder
     # run: rm -rf ./publish





# This workflow will build a .NET project
# For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-net

#name: .NET

#on:
#  push:
#    branches: [ "main" ]
#  pull_request:
#    branches: [ "main" ]
#
#jobs:
#  build:
#
#    runs-on: self-hosted
#
#    steps:
 #   - uses: actions/checkout@v3
 #   - name: Setup .NET
#      uses: actions/setup-dotnet@v3
 #     with:
 #       dotnet-version: 7.0.202
 #   - name: Restore dependencies
 #     run: dotnet restore
  #  - name: Build
  #    run: dotnet build --no-restore
   # - name: Test
   #   run: dotnet test --no-build --verbosity normal
